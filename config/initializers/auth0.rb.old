Rails.application.config.middleware.use OmniAuth::Builder do
  if ENV['AUTH0_AUDIENCE'].blank?
    audience = URI::HTTPS.build(host: ENV['AUTH0_DOMAIN'], path: '/userinfo').to_s
  else
    audience = ENV['AUTH0_AUDIENCE']
  end

  provider(
    :auth0,
    'bgvKH1B1fBm0oSV3Sqz0T4-RHXDCW0zb',
    'OzIHScXETsrlkWzTGOrwb3CIgezrhTvF-Zlr6SXULDFfbDRA8nYoQA4v43g5-sY_',
    'znow.eu.auth0.com',
    #ENV['AUTH0_CLIENT_ID'],
    #ENV['AUTH0_CLIENT_SECRET'],
    #ENV['AUTH0_DOMAIN'],
    callback_path: '/users/auth/auth0/callback',
    authorize_params: {
      scope: 'openid profile',
      audience: audience
    }
  )
end